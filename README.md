# PES_Ripple-CA

### What is Ripple Carry Adder?

A structure of multiple full adders is cascaded in a manner to gives the results of the addition of an n bit binary sequence. This adder includes cascaded full adders in its structure so, the carry will be generated at every full adder stage in a ripple-carry adder circuit. These carry output at each full adder stage is forwarded to its next full adder and there applied as a carry input to it. This process continues up to its last full adder stage. So, each carry output bit is rippled to the next stage of a full adder. By this reason, it is named as “RIPPLE CARRY ADDER”. The most important feature of it is to add the input bit sequences whether the sequence is 4 bit or 5 bit or any.
“One of the most important point to be considered in this carry adder is the final output is known only after the carry outputs are generated by each full adder stage and forwarded to its next stage. So there will be a delay to get the result with using of this carry adder”.


![Screenshot from 2023-10-18 17-23-52](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/f567ae74-e07f-444a-8bf8-5343f5bab044)



### Working of 4-bit Ripple Carry Adder

 - Let’s take an example of two input sequences 0101 and 1010. These are representing the A4 A3 A2 A1 and B4 B3 B2 B1.
 - As per this adder concept, input carry is 0.
 - When Ao & Bo are applied at 1st full adder along with input carry 0.
 - Here A1 =1 ; B1=0 ; Cin=0
 - Sum (S1) and carry (C1) will be generated as per the Sum and Carry equations of this adder. As per its theory, the output equation for the Sum = A1⊕B1⊕Cin and Carry = A1B1⊕B1Cin⊕CinA1
 - As per this equation, for 1st full adder S1 =1 and Carry output i.e., C1=0.
 - Same like for next input bits A2 and B2, output S2 = 1 and C2 = 0. Here the important point is the second stage full adder gets input carry i.e., C1 which is the output carry of initial stage       full adder.
 - Like this will get the final output sequence (S4 S3 S2 S1) = (1 1 1 1) and Output carry C4 = 0
 - This is the addition process for 4-bit input sequences when it’s applied to this carry adder.



## Installation

For installation and more details regarding iverilog, yosys and gtkwave, refer to :

https://github.com/Vinodkumar8318/pes_asic_class


## Simulation

+ `iverilog PES_RCA.v PES_FA.v PES_RCA_TB.v`
+ `./a.out`
+ `gtkwave PES_RCA.vcd`



![Screenshot from 2023-10-18 16-32-24](https://github.com/Vinodkumar8318/PES_Ripple-CA/assets/142583979/a8db44b0-fe09-4a7b-b27f-05a4f7ac4660)

![Screenshot from 2023-10-18 16-36-16](https://github.com/Vinodkumar8318/PES_Ripple-CA/assets/142583979/8fb70553-021e-41cf-b1d2-95dae4e9a2c2)

![Screenshot from 2023-10-18 16-40-36](https://github.com/Vinodkumar8318/PES_Ripple-CA/assets/142583979/d4797e84-6995-494d-94dc-b7b38d3723f2)


## Synthesis
+ Invoke `yosys`
+ `read_liberty -lib lib/sky130_fd_sc_hd__tt_025C_1v80.lib`
+ `read_verilog PES_RCA.v PES_FA.v`
+ `synth -top PES_RCA`
+ `dfflibmap -liberty lib/sky130_fd_sc_hd__tt_025C_1v80.lib `
+ `abc -liberty lib/sky130_fd_sc_hd__tt_025C_1v80.lib`
+ `flatten`
+ `write_verilog PES_RCA_netlist.v`
+ `show PES_RCA`

![Screenshot from 2023-10-18 16-55-51](https://github.com/Vinodkumar8318/PES_Ripple-CA/assets/142583979/7ac40242-1ac8-471f-a72e-9232669049d5)


![Screenshot from 2023-10-18 16-59-28](https://github.com/Vinodkumar8318/PES_Ripple-CA/assets/142583979/e2a7649c-6ea4-44db-8516-037246e29121)



## Gate-Level Simulation

+ `iverilog my_lib/verilog_model/primitives.v my_lib/verilog_model/sky130_fd_sc_hd.v PES_RCA_netlist.v PES_RCA_TB.v`
+ `./a.out`
+ `gtkwave PES_RCA.vcd`


![Screenshot from 2023-10-18 17-11-32](https://github.com/Vinodkumar8318/PES_Ripple-CA/assets/142583979/4a17c7d8-2655-48d7-bc16-b6296053f8b1)


![Screenshot from 2023-10-18 17-12-11](https://github.com/Vinodkumar8318/PES_Ripple-CA/assets/142583979/fe61ee59-7b16-4340-bcf8-5ad0ef8a30fa)


![Screenshot from 2023-10-18 17-09-35](https://github.com/Vinodkumar8318/PES_Ripple-CA/assets/142583979/6e27ee1b-5b05-440a-88b8-9565190c18ee)

We can observe that output of functional simulation is matching with the output of gate level simulation, this means that the netlist generated by yosys is correct.



# STAGE2 (RTL2GDSII - OPENLANE) - Table of contents

![image](https://github.com/Pavan2280/pes_pd/assets/131603225/24e63c09-da0d-4da6-943c-f54d6abbda85)

#### Design Stages

1) **Synthesis**
   1. **yosys** - Yosys performs RTL synthesis, converting high-level RTL descriptions into gate-level netlists.
   2. **abc** - ABC is used for further optimization and technology mapping to enhance the gate-level design.
   3. **OpenSTA** - OpenSTA conducts static timing analysis to verify if the synthesized design meets timing constraints in the OpenLane flow.

2) **Floorplan & PND**
   1. **init_fp (Initial Floorplan)** - Floorplanning involves determining the initial placement and arrangement of various functional blocks or cells within the chip's       
   layout area.
   2. **ioplacer** - ioplacer is a tool used in the physical design process to place Input/Output (I/O) pads or pins on the chip's boundary.
   3. **pdn** - The PDN is responsible for distributing power (supply voltage) and ground (reference voltage) throughout the chip, ensuring that all components receive the       necessary power supply and maintain stable electrical operation.
   4. **tapcell** - A "tapcell" is a special type of cell used in digital integrated circuit design, particularly in standard cell libraries.It is typically used to create 
   tap connections for the bulk terminals in digital CMOS (Complementary Metal-Oxide-Semiconductor) designs.

3) **Placement**
   1. **Replace** - RePlace is a tool used in the OpenLane flow for cell placement optimization.It focuses on optimizing the placement of standard cells within the chip's   
   layout to achieve better area utilization, timing, and power efficiency.
   2. **Resizer** - Resizer is a tool employed during the physical design process to perform cell resizing and optimization.
   3. **OpenDP (Open Detailed Placement)** - OpenDP, or Open Detailed Placement, is a detailed placement tool used in OpenLane.It is responsible for the fine-grained 
   placement of cells, ensuring that they are precisely positioned within rows and tracks while adhering to design constraints and achieving optimal utilization of the chip's 
   layout area.
   4. **OpenPhysyn (Open Physical Synthesis)** - OpenPhysyn is a tool within OpenLane that performs physical synthesis tasks.It optimizes the logical and physical aspects of 
   the design simultaneously, improving the placement, power, area, and timing by considering both logic and physical information during the optimization process.

4) **CTS**
   1. **TritonCTS** - TritonCTS generates a clock distribution network.

5) **Routing**
   1. **FastRoute** - FastRoute is a global routing tool used in the physical design stage of ASIC chip design.
   2. **TritonRoute** - TritonRoute is a detailed or global routing tool used in the later stages of ASIC chip design, following placement and initial global routing.
   
6) **GDSII Generation**
   1. **Magic** - Magic is primarily a layout tool used for creating and editing IC layouts, and it is often used for digital CMOS design.
   2. **KLayout** - KLayout is primarily used for viewing, editing, and analyzing IC layouts but is not a layout creation tool like Magic.
   
8) **Checks**
   1. **CVC** - CVC is a tool primarily used for verification and debugging of digital designs.
   2. **Netgen** - Netgen is an open-source digital netlist comparison and LVS (Layout vs. Schematic) tool.


  
## Installation of yosys, ngspice, magic and OpenLANE

**yosys**
```
git clone https://github.com/YosysHQ/yosys.git
cd yosys
sudo apt install make (If make is not installed please install it) 
sudo apt-get install build-essential clang bison flex \
    libreadline-dev gawk tcl-dev libffi-dev git \
    graphviz xdot pkg-config python3 libboost-system-dev \
    libboost-python-dev libboost-filesystem-dev zlib1g-dev
make config-gcc
make 
sudo make install
```


**ngspice**
- Download the tarball from https://sourceforge.net/projects/ngspice/files/ to a local directory
```
cd $HOME
sudo apt-get install libxaw7-dev
tar -zxvf ngspice-41.tar.gz
cd ngspice-41
mkdir release
cd release
../configure  --with-x --with-readline=yes --disable-debug
sudo make
sudo make install
```

**magic**
```
sudo apt-get install m4
sudo apt-get install tcsh
sudo apt-get install csh
sudo apt-get install libx11-dev
sudo apt-get install tcl-dev tk-dev
sudo apt-get install libcairo2-dev
sudo apt-get install mesa-common-dev libglu1-mesa-dev
sudo apt-get install libncurses-dev
git clone https://github.com/RTimothyEdwards/magic
cd magic
./configure
sudo make
sudo make install
```

**OpenLANE**
```
sudo apt-get update
sudo apt-get upgrade
sudo apt install -y build-essential python3 python3-venv python3-pip make git

sudo apt install apt-transport-https ca-certificates curl software-properties-common
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg

echo "deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

sudo apt update
sudo apt install docker-ce docker-ce-cli containerd.io
sudo docker run hello-world
sudo groupadd docker
sudo usermod -aG docker $USER
sudo reboot 
# After reboot
docker run hello-world (should show you the output under 'Example Output' in https://hub.docker.com/_/hello-world)

- To install the PDKs and Tools
cd $HOME
git clone https://github.com/The-OpenROAD-Project/OpenLane
cd OpenLane
make
make test
```


## Creating design folder through openlane

To create a design folder with a default config.json file, follow the below command

```
cd
cd OpenLane
make mount
./flow.tcl -design PES_RCA -init_design_config
```

![Screenshot from 2023-11-03 19-42-58](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/7b0c787b-7fbd-4c19-9f1c-44ed619da144)


In a new tab,

```
cd ~/OpenLane/openlane/PES_RCA
mkdir src
cd src
gedit PES_RCA.v
```

write verilog code for your design or paste it and save it

![image](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/e1bc9e5c-c166-41ba-b401-bcc8b140e27d)

Now Open the config.json file from your <DESIGN FILE> folder, Add the  dir path for the verilog files in Config.json file.

```
dir::src/PES_RCA.v

```
Below are the default config.json file and the Path updated Config.json file

![Screenshot from 2023-11-03 19-59-14](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/29fa9d7b-c099-4e27-92d0-fe4581d096c6)

After adding,

![Screenshot from 2023-11-03 19-59-38](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/b86b43de-894f-46dd-9876-35b43eb5fecb)


## Running a basic automated flow

- The errors encountered here helps to find the variables to be set in the ```config.json``` file inorder to resolve the error.
- The warning messages also gives an info of what extra variables to be defined in the json file
- By end of this automated flow without any error or flow related warnings after some iterations, You will have a proper populated config.json file
- This json file can be used to go on with interactive flow where you can change the variables in between the flow if required

The command to run the automated flow is 

```
./flow.tcl -design openlane/PES_RCA -tag RUN1
```

![Screenshot from 2023-11-03 21-36-57](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/ce06e6bf-df5a-44ee-9dff-63f33976df82)


#### Errors and Solution while running the above command

1) If u any any Pitch error in the Floorplan step (STEP-6) 

![Screenshot from 2023-11-03 20-12-03](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/6eae447c-7625-4f48-8c8d-3e8d9891c874)

Add the below set commands in the ```pdn_cfg.tcl``` file

![Screenshot from 2023-11-04 12-03-29](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/9ee184d5-d518-4c0d-b5af-9e3c91bfc6e6)

2) If u find any -Density error in the Placement step (Step-7)

![image](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/d81d3a18-259f-47d0-ba6a-b756a7285919)

Add the following command in the gpl.tcl file, Set the -density as ```lappend arg_list -density 0.70;```

![Screenshot from 2023-11-03 21-57-46](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/c91bd8f3-dccf-4a57-acf1-5e7785c38041)

#### After correcting the errors re run the command again the Flow will be completed as success.

![Screenshot from 2023-11-03 21-37-10](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/8aa6089e-767d-46a0-a9b2-96e1f3dfe791)


Here we can observe a warning saying that the core area is too small and it set an area by itself. But we can specify the area by including the corresponding variable in the json file.

![Screenshot from 2023-11-04 17-30-54](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/487ffbf6-4de9-4e61-8c14-0edbbf10b1dc)


## Interactive flow 

The variables that can be changed for particular step of interactive flow can be found at ```OpenLane/configuratons``` in the form of <STAGE>.tcl

1. **Initiate the interactive flow** - ```./flow.tcl -interactive```
2. **prepare the design for the flow** - ```prep -design openlane/PES_RCA -tag RUN1-final```  (the Run name can be any)

![Screenshot from 2023-11-04 17-22-27](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/917c9f5c-06ff-4bf3-af17-2e3665665fc5)



3. **Run Synthesis** - ```run_synthesis```

![Screenshot from 2023-11-04 17-22-51](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/442f343d-11db-4cc9-83b6-8dfad22b0b93)

![Screenshot from 2023-11-04 17-08-24](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/5ac0cd88-e5be-42b9-b8f6-f14f2154b137)



4. **Run Floorplan** - ```run_floorplan```

![Screenshot from 2023-11-04 17-23-06](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/0a38aaee-b360-4bdb-a9d9-61d30490e71d)

Open the new teminal and enter into FLOORPLAN directory and run the following Magic command
```magic -T /home/vinodkumar/Downloads/sky130A.tech lef read ../../tmp/merged.nom.lef def PES_RCA.def &```

![Screenshot from 2023-11-04 17-23-30](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/13a1b36e-da92-43df-8684-a5f43c506ede)

![Screenshot from 2023-11-04 17-20-06](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/fc91d3aa-adc1-404e-803a-057739d1e194)

![Screenshot from 2023-11-04 17-19-22](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/4593e1af-4bed-4f3c-9d77-e12439803628)



5. **Run Placement** - ```run_placement```
   
![Screenshot from 2023-11-04 17-23-52](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/52a4558c-d4d0-4b3d-8e0d-1e7f3e3feb73)

Open the new teminal and enter into PLACEMENT directory and run the following Magic command
```magic -T /home/vinodkumar/Downloads/sky130A.tech lef read ../../tmp/merged.nom.lef def PES_RCA.def &```

![Screenshot from 2023-11-04 17-26-07](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/44180bb8-4d1f-475e-ace9-fbadb84b47ef)

![Screenshot from 2023-11-04 17-25-10](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/9e9b8fc9-55b3-4871-8e58-284c38ff13d4)

![Screenshot from 2023-11-04 17-25-29](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/ebe31aaf-f5dc-4247-b49f-33782a993430)



6. **Run CTS** - ```run_cts```

![Screenshot from 2023-11-04 17-27-01](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/ac0026fa-6062-4ac1-8376-e3f5d19cef08)



#### The reports Generated are Given Below

![Screenshot from 2023-11-04 17-35-05](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/d7ff9d87-87e6-4f19-9b21-6f7f37817b73)

![Screenshot from 2023-11-04 17-35-20](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/c54a110e-1abb-445a-a69d-2485c8aaa34a)

![Screenshot from 2023-11-04 17-35-36](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/5e29500c-8656-4f33-b4a1-b344e709eb30)

![Screenshot from 2023-11-04 17-35-56](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/efefc554-2130-45cb-a9bd-b306ed2ee93e)

![Screenshot from 2023-11-04 17-36-10](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/6430d086-bd12-4266-8c9c-70f2e87aa71a)

![Screenshot from 2023-11-04 17-36-37](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/95c099fe-c2a7-4cbd-a093-ee11d1f33e0b)

![Screenshot from 2023-11-04 17-36-45](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/cdb02d2d-2c30-46c8-a27d-c37367bcc594)



7. **Run Routing** - ```run_routing```

![Screenshot from 2023-11-04 17-27-41](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/710d5c1b-ad95-4f2c-8ecc-d3d2b890e06a)

Open the new teminal and enter into ROUTING directory and run the following Magic command
```magic -T /home/vinodkumar/Downloads/sky130A.tech lef read ../../tmp/merged.nom.lef def PES_RCA.def &```

![Screenshot from 2023-11-04 17-30-23](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/0983fe64-2e67-42d6-96a3-51f959a6422b)

![Screenshot from 2023-11-04 17-29-57](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/6339de44-2caf-4776-ae84-3ddafccb2dee)

![Screenshot from 2023-11-04 17-29-22](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/f6a1790e-7089-4f09-a764-bfb68e215fae)

![Screenshot from 2023-11-04 17-29-37](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/c2573026-95f6-436d-b3c7-835b2c68c375)



#### Tns, Wns and Slack report

![Screenshot from 2023-11-04 17-39-57](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/30591053-8a1b-4f0e-a7c5-8f0b87e4d792)


#### Power Report

![Screenshot from 2023-11-04 17-38-04](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/30bfd751-6733-4975-8229-347e4c7d1953)


#### Area Report and the Utilization

![Screenshot from 2023-11-04 17-40-13](https://github.com/Vinodkumar8318/PES_4-Bit-RCA/assets/142583979/006c2162-cb73-482c-aa11-570f45c42953)


## Statistics

    Area = 238 u ^ 2  
    Utilization = 60% utilization
    Internal Power = 6.28e-06 W  (37.5%)
    Switching Power = 1.05e-05 (62.5%)
    Leakage Power = 1.47e-10 (0%)
    Total Power = 1.67e-05 (100%)
































